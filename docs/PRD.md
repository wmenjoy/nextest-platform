# 测试管理平台增强 - 产品需求文档 (PRD)

**文档版本**: 1.0
**创建日期**: 2025-11-21
**产品负责人**: 测试平台团队
**目标发布**: Q2 2025

---

## 📋 文档目录

1. [产品概述](#产品概述)
2. [产品目标](#产品目标)
3. [用户画像](#用户画像)
4. [核心功能](#核心功能)
5. [功能优先级](#功能优先级)
6. [用户体验设计](#用户体验设计)
7. [成功指标](#成功指标)
8. [技术约束](#技术约束)
9. [发布计划](#发布计划)
10. [竞品分析](#竞品分析)

---

## 产品概述

### 背景

当前测试管理系统已具备基础的测试用例管理和执行功能，但在大规模测试场景、复杂业务流程测试、以及团队协作方面存在明显短板。随着业务复杂度的提升，团队对测试平台的需求已从"能用"升级到"好用、高效、智能"。

### 产品定位

**从测试管理工具升级为企业级测试平台**

- **当前定位**: 简单的测试用例管理工具
- **目标定位**: 全生命周期测试自动化平台
- **差异化**: 工作流编排 + 脚本化 + 数据驱动 + 可视化

### 核心价值主张

| 用户角色 | 核心价值 |
|---------|---------|
| **QA工程师** | 10倍效率提升，从手工创建到批量导入 |
| **自动化测试工程师** | 灵活编排复杂测试场景，脚本化扩展能力 |
| **测试负责人** | 标准化模板，降低新人上手成本 |
| **开发工程师** | 可视化测试结果，快速定位问题 |

---

## 产品目标

### 业务目标

1. **效率提升**: 测试用例创建效率提升 **100倍**（从1个/分钟到100个/分钟）
2. **覆盖增强**: 支持复杂业务流程的端到端测试
3. **团队赋能**: 降低测试编写门槛，新人上手时间从3天降至1天
4. **成本优化**: 减少重复劳动，节省 **50%** 测试维护成本

### 用户目标

- **降低学习成本**: 通过模板和可视化，技术门槛降低70%
- **提高工作效率**: 批量操作、自动化编排，日常工作时间节省60%
- **增强测试能力**: 脚本化支持复杂逻辑，覆盖原本无法测试的场景
- **改善体验**: 现代化UI，流畅的交互体验

### 技术目标

- **可扩展性**: 支持10,000+测试用例，1,000+并发执行
- **稳定性**: 工作流执行成功率 > 95%
- **性能**: 页面加载时间 < 2秒，API响应时间 < 500ms
- **安全性**: 脚本沙箱执行，零安全漏洞

---

## 用户画像

### 主要用户角色

#### 👤 角色1: QA测试工程师（占比60%）

**基本信息**:
- 年龄: 25-35岁
- 经验: 2-5年测试经验
- 技能: 熟悉测试理论，基础编程能力

**痛点**:
- ❌ 手工创建大量测试用例，重复劳动多
- ❌ 测试数据维护困难，无法版本管理
- ❌ 复杂场景难以覆盖，需要多个工具配合

**需求**:
- ✅ 批量导入测试用例
- ✅ 数据驱动测试
- ✅ 模板化快速创建
- ✅ 测试结果可视化

**使用场景**:
> "每次接口变更，我需要更新200+个测试用例，手工修改要花一整天。如果能从Excel批量导入就好了。"

---

#### 👨‍💻 角色2: 自动化测试工程师（占比25%）

**基本信息**:
- 年龄: 28-40岁
- 经验: 5-10年测试/开发经验
- 技能: 精通编程，熟悉测试框架

**痛点**:
- ❌ 现有工具表达能力有限，无法实现复杂逻辑
- ❌ 测试步骤固化，难以灵活编排
- ❌ 缺乏编程能力扩展

**需求**:
- ✅ 工作流编排能力
- ✅ 脚本化测试（Lua）
- ✅ 自定义断言和处理逻辑
- ✅ CI/CD集成

**使用场景**:
> "我需要测试'注册→登录→下单→支付→退款'的完整流程，但现在每个步骤都是独立的，无法传递状态。"

---

#### 👔 角色3: 测试负责人/主管（占比10%）

**基本信息**:
- 年龄: 30-45岁
- 经验: 8-15年经验
- 关注点: 团队效率、质量标准、成本

**痛点**:
- ❌ 团队测试质量参差不齐
- ❌ 新人培训成本高
- ❌ 缺乏统一标准和规范

**需求**:
- ✅ 标准化模板库
- ✅ 团队协作功能
- ✅ 测试覆盖率统计
- ✅ 质量趋势分析

**使用场景**:
> "新来的QA不知道如何写规范的测试用例，每次都要手把手教。希望有标准模板让他们参考。"

---

#### 🔧 角色4: 开发工程师（占比5%）

**基本信息**:
- 年龄: 25-35岁
- 经验: 3-8年开发经验
- 关注点: 快速定位问题、测试覆盖

**痛点**:
- ❌ 测试失败时难以定位原因
- ❌ 测试结果展示简陋

**需求**:
- ✅ 详细的错误日志
- ✅ 可视化调用链
- ✅ 快速重现问题

**使用场景**:
> "测试报告只说'断言失败'，但我不知道是哪个字段、期望什么值、实际什么值。"

---

## 核心功能

### 功能1: 测试数据批量导入

#### 功能描述

支持从CSV、Excel、JSON、YAML等格式的文件批量导入测试用例，解放手工创建的重复劳动。

#### 功能价值

- **效率提升**: 100个测试用例从100分钟降至1分钟（**100倍**）
- **数据管理**: 测试数据可纳入版本控制
- **团队协作**: QA可在Excel中准备数据，技术人员导入系统

#### 功能详情

**支持格式**:
- ✅ CSV（简单、通用）
- ✅ Excel (.xlsx)（复杂结构、多Sheet）
- ✅ JSON（灵活、嵌套）
- ✅ YAML（可读性好）

**导入策略**:
- **增量导入**: 仅添加不存在的测试用例
- **覆盖导入**: 更新已存在的测试用例
- **校验导入**: 先验证、后确认、再导入

**错误处理**:
- 逐行验证，详细错误报告
- 支持部分成功（成功N条，失败M条）
- 可下载错误报告（CSV格式）

#### 用户界面

**导入页面**:
```
┌─────────────────────────────────────────┐
│  📥 批量导入测试用例                    │
├─────────────────────────────────────────┤
│                                         │
│  1️⃣ 选择文件格式                        │
│     ○ CSV   ○ Excel   ○ JSON   ○ YAML  │
│                                         │
│  2️⃣ 上传文件                            │
│     ┌─────────────────────────────┐    │
│     │  拖拽文件到此处              │    │
│     │  或点击选择文件              │    │
│     └─────────────────────────────┘    │
│                                         │
│  3️⃣ 导入设置                            │
│     导入策略: [增量导入 ▼]              │
│     目标分组: [API Tests ▼]             │
│                                         │
│  4️⃣ 预览 & 验证                         │
│     ┌─────────────────────────────┐    │
│     │ ✅ 100 条有效                │    │
│     │ ⚠️  5 条警告                 │    │
│     │ ❌ 2 条错误                  │    │
│     └─────────────────────────────┘    │
│                                         │
│     [查看详情]  [下载错误报告]          │
│                                         │
│  [取消]              [开始导入 →]       │
└─────────────────────────────────────────┘
```

#### 验收标准

- [ ] 支持4种文件格式（CSV、Excel、JSON、YAML）
- [ ] 导入1000条数据 < 10秒
- [ ] 错误率 < 0.1%（验证准确性）
- [ ] 提供详细的错误报告
- [ ] 支持导入历史查询

---

### 功能2: 工作流编排

#### 功能描述

通过YAML/可视化方式定义多步骤测试工作流，支持步骤间数据传递、条件执行、错误处理。

#### 功能价值

- **场景覆盖**: 支持端到端业务流程测试
- **状态管理**: 步骤间共享数据（如认证token）
- **灵活编排**: 顺序、并行、条件、循环执行
- **可复用**: 工作流可作为模板复用

#### 功能详情

**核心能力**:
- ✅ 步骤定义（HTTP测试、命令执行、Lua脚本、数据库操作）
- ✅ Action/Function抽象（内置Action + Lua自定义Function）
- ✅ 依赖关系（步骤A依赖步骤B，DAG拓扑排序）
- ✅ 变量传递（${variable} 语法）
- ✅ 条件执行（when: ${condition}，支持复杂表达式）
- ✅ 错误策略（abort、continue、retry with exponential backoff）
- ✅ 控制流（if-else、for-each、while循环）
- ✅ 事件触发（Webhook、定时、文件监听）
- ✅ 子工作流调用（嵌套工作流，最大深度5层）
- ✅ **实时监控**（WebSocket推送执行状态、数据流追踪）

**工作流定义示例**:
```yaml
workflow:
  name: "电商下单流程"
  steps:
    - id: register
      name: 注册用户
      testId: user-register
      output:
        userId: "response.data.id"

    - id: login
      name: 用户登录
      testId: user-login
      dependsOn: [register]
      input:
        userId: "${register.userId}"
      output:
        token: "response.data.token"

    - id: create-order
      name: 创建订单
      testId: order-create
      dependsOn: [login]
      headers:
        Authorization: "Bearer ${login.token}"
```

#### 用户界面

**可视化编辑器** (Phase 4):
```
┌─────────────────────────────────────────────┐
│  🔀 工作流编辑器 - 电商下单流程             │
├─────────────────────────────────────────────┤
│  工具箱          │  画布                    │
│  ┌────────┐     │                          │
│  │ HTTP   │     │   ┌────────────┐         │
│  │ 命令   │     │   │  注册用户  │         │
│  │ Lua    │     │   └─────┬──────┘         │
│  │ 子流程 │     │         │                │
│  └────────┘     │   ┌─────▼──────┐         │
│                 │   │  用户登录  │         │
│                 │   └─────┬──────┘         │
│                 │         │                │
│                 │   ┌─────▼──────┐         │
│                 │   │  创建订单  │         │
│                 │   └────────────┘         │
└─────────────────────────────────────────────┘
```

**YAML编辑器** (Phase 2):
```
┌─────────────────────────────────────────┐
│  📝 YAML 编辑器                         │
├─────────────────────────────────────────┤
│  1  workflow:                           │
│  2    name: "电商下单流程"              │
│  3    steps:                            │
│  4      - id: register                  │
│  5        name: 注册用户                │
│  6        testId: user-register         │
│  7        output:                       │
│  8          userId: "response.data.id"  │
│                                         │
│  [语法检查 ✓]  [预览流程图]  [保存]     │
└─────────────────────────────────────────┘
```

#### 工作流实时监控

**核心需求**: 工作流执行过程中，用户能够实时查看执行状态和数据流向。

**监控能力**:
- ✅ **步骤状态追踪**: 实时显示每个步骤的状态（pending/running/success/failed）
- ✅ **数据流可视化**: 显示数据在步骤间的流动（输入→处理→输出）
- ✅ **变量监控**: 实时查看全局变量和步骤输出的变化
- ✅ **执行日志流**: WebSocket实时推送步骤执行日志
- ✅ **性能指标**: 每个步骤的耗时、成功率统计
- ✅ **调用链追踪**: 类似Jaeger的调用链可视化

**实时推送事件**:
```json
// 工作流启动
{"type": "workflow_started", "data": {...}}

// 步骤开始
{"type": "step_started", "data": {"stepId": "login", ...}}

// 步骤完成
{
  "type": "step_completed",
  "data": {
    "stepId": "login",
    "status": "success",
    "duration": 150,
    "outputData": {"token": "abc..."}
  },
  "context": {
    "variables": {"userId": 123, "token": "abc..."},
    "stepOutputs": {...}
  }
}

// 实时日志
{"type": "log", "data": {"level": "info", "message": "发送HTTP请求", ...}}

// 变量变更
{"type": "variable_changed", "data": {"name": "token", "oldValue": null, "newValue": "abc..."}}
```

**UI设计**:
```
┌─────────────────────────────────────────────────┐
│  工作流执行监控 - 用户注册流程                  │
│  状态: ⏳ 运行中  已执行: 3/5  耗时: 2.5s       │
├─────────────────────────────────────────────────┤
│  步骤列表                    │  变量监控         │
│  ✅ 1. 注册用户 (200ms)     │  userId: 123     │
│     Input: {username: ...}  │  token: "abc..." │
│     Output: {userId: 123}   │                  │
│                             │                  │
│  ✅ 2. 用户登录 (150ms)     │  实时日志         │
│     Input: {userId: 123}    │  [10:30:01] 步骤1│
│     Output: {token: ...}    │  发送POST请求... │
│                             │  [10:30:01] 响应 │
│  ⏳ 3. 创建订单 (执行中)    │  200 OK          │
│     Input: {token: ...}     │  [10:30:02] 步骤2│
│                             │  开始登录...     │
│  ⏸️  4. 支付订单 (等待)     │                  │
│  ⏸️  5. 清理数据 (等待)     │                  │
└─────────────────────────────────────────────────┘
```

**数据流向图** (Phase 4可视化):
- 使用React Flow绘制步骤节点
- 箭头表示数据流向和依赖关系
- 节点颜色表示状态（绿色=成功，红色=失败，蓝色=运行中）
- 点击节点查看输入/输出详情

**技术实现**:
- WebSocket实时推送（/api/v2/workflows/runs/:runId/stream）
- 数据库记录: workflow_runs, workflow_step_executions, workflow_step_logs, workflow_variable_changes
- 前端使用WebSocket + React状态管理实时更新UI

#### 验收标准

- [ ] 支持YAML格式定义工作流
- [ ] 支持至少10个步骤的工作流
- [ ] 变量替换准确率100%
- [ ] 依赖解析正确（拓扑排序）
- [ ] 错误处理策略生效
- [ ] **实时监控**: WebSocket推送延迟 < 100ms
- [ ] **数据流追踪**: 100%记录输入/输出数据
- [ ] **日志完整性**: 所有步骤日志可查询
- [ ] Phase 2: YAML编辑器 + 实时监控UI
- [ ] Phase 4: 可视化编辑器 + 数据流向图

---

### 功能3: 测试案例与工作流集成

#### 功能描述

实现测试案例与工作流的双向集成,使测试案例可以是工作流(复杂多步骤测试),工作流也可以引用测试案例(复用已有测试),通过统一的界面管理和执行。

#### 功能价值

- **统一管理**: 不再区分"测试"和"工作流",统一视图管理所有测试资源
- **灵活复用**: 工作流可引用测试案例,测试案例可封装为工作流
- **降低复杂度**: 用户只需理解"测试案例"一个概念,无需学习两套系统
- **真正实施**: 测试管理工具不仅管理案例,案例还能真正执行起来

#### 核心问题

**用户需求**: "测试案例的配置要能兼容工作流,测试管理工具不仅管理案例,案例还能真正的实施起来"

**设计目标**:
1. ✅ 测试案例可以是工作流(复杂的多步骤测试)
2. ✅ 工作流可以引用测试案例(复用已有测试)
3. ✅ 统一的测试管理界面(列表、执行、结果、历史)
4. ✅ 统一的执行引擎(无论是单一测试还是工作流)
5. ✅ 保持向后兼容(不影响现有测试案例)

#### 三种集成模式

**模式1: 测试案例引用工作流** (推荐用于复杂场景)

```json
{
  "testId": "e2e-order-flow",
  "name": "完整订单流程测试",
  "type": "workflow",
  "workflowId": "workflow-order-v2.1",
  "priority": "P0",
  "timeout": 600,
  "assertions": [
    {"type": "workflow_success"},
    {"type": "step_count", "expected": 5}
  ]
}
```

**使用场景**:
- 端到端的业务流程测试
- 需要复杂编排的测试场景
- 工作流需要独立管理和版本控制

**优点**:
- 工作流可以独立管理(版本、修改、复用)
- 多个测试案例可以引用同一个工作流
- 清晰的职责分离

**模式2: 测试案例内嵌工作流** (推荐用于简单场景)

```json
{
  "testId": "login-and-query",
  "name": "登录后查询用户数据",
  "type": "workflow",
  "workflowDef": {
    "steps": [
      {
        "id": "login",
        "type": "http",
        "http": {"method": "POST", "path": "/api/auth/login"},
        "output": {"token": "response.data.token"}
      },
      {
        "id": "query",
        "type": "http",
        "dependsOn": ["login"],
        "http": {
          "method": "GET",
          "path": "/api/users/me",
          "headers": {"Authorization": "Bearer ${login.token}"}
        }
      }
    ]
  }
}
```

**使用场景**:
- 简单的多步骤测试(2-5步)
- 不需要复用的测试流程
- 快速创建测试,无需管理独立工作流

**优点**:
- 测试定义完全自包含
- 创建简单,无需额外管理工作流

**模式3: 工作流引用测试案例** (复用已有测试)

```yaml
workflow:
  steps:
    - id: test-user-create
      type: test-case
      testId: "api-user-create"
      output:
        userId: "response.data.id"

    - id: test-user-login
      type: test-case
      testId: "api-user-login"
      dependsOn: [test-user-create]
      input:
        username: "${test-user-create.username}"
```

**使用场景**:
- 在工作流中复用已有的测试案例
- 组合多个独立测试形成流程
- 测试案例需要独立维护

**优点**:
- 测试案例独立管理,可以单独执行
- 工作流复用已有的测试逻辑
- 测试案例修改自动反映到工作流中

#### 数据模型扩展

**TestCase模型**:
```go
type TestCase struct {
    // ... 现有字段 ...
    Type string  // 扩展为支持 "workflow"

    // === 新增字段: 工作流支持 ===
    WorkflowID  string `json:"workflowId,omitempty"`   // 引用工作流ID (模式1)
    WorkflowDef JSONB  `json:"workflowDef,omitempty"`  // 内嵌工作流定义 (模式2)
}
```

**Workflow模型**:
```go
type Workflow struct {
    // ... 现有字段 ...

    // === 新增字段: 测试案例关联 ===
    IsTestCase bool       `json:"isTestCase"`  // 是否被测试案例引用
    TestCases  []TestCase `json:"-"`           // 反向关联
}
```

#### API设计

**创建工作流类型的测试案例**:
```bash
POST /api/v2/tests

# 模式1: 引用工作流
{
  "testId": "e2e-order-flow",
  "type": "workflow",
  "workflowId": "workflow-order-v2.1"
}

# 模式2: 内嵌工作流
{
  "testId": "login-query",
  "type": "workflow",
  "workflowDef": { "steps": [...] }
}
```

**执行工作流测试案例**:
```bash
POST /api/v2/tests/:testId/execute
```

**查询引用某个工作流的测试案例**:
```bash
GET /api/v2/workflows/:workflowId/test-cases
```

#### 用户界面

**测试列表 - 显示工作流类型**:
```
┌─────────────────────────────────────────────────────────┐
│  测试案例列表                                [新建测试 ▼]│
├─────────────────────────────────────────────────────────┤
│  名称                    类型        优先级  状态    操作│
│  📡 获取用户列表          HTTP        P1     ✅       执行│
│  🔀 用户注册流程         Workflow    P0     ✅       执行│  ← 工作流测试
│  🔀 订单完整流程         Workflow    P0     ✅       执行│  ← 工作流测试
└─────────────────────────────────────────────────────────┘
```

**工作流测试结果展示**:
```
┌─────────────────────────────────────────────────────────┐
│  测试结果 - 订单完整流程测试                            │
│  状态: ✅ 通过  执行时间: 5分30秒                       │
├─────────────────────────────────────────────────────────┤
│  概览:                                                  │
│  总步骤: 5个  ✅ 成功: 5个  ❌ 失败: 0个               │
│                                                         │
│  步骤详情:                                              │
│  ✅ 1. register - 注册用户      (200ms)                │
│     Output: {userId: 12345}                             │
│  ✅ 2. login - 用户登录         (150ms)                │
│     Output: {token: "eyJ..."}                           │
│  ✅ 3. create-order - 创建订单  (300ms)                │
│     Output: {orderId: 67890}                            │
└─────────────────────────────────────────────────────────┘
```

#### 验收标准

- [ ] 支持测试案例type="workflow"
- [ ] 模式1: TestCase通过workflowId引用Workflow
- [ ] 模式2: TestCase通过workflowDef内嵌Workflow定义
- [ ] 模式3: Workflow步骤支持type="test-case"引用TestCase
- [ ] UnifiedTestExecutor统一执行入口
- [ ] 工作流执行结果映射为测试结果
- [ ] 测试列表UI显示工作流类型
- [ ] 工作流测试结果详细展示(步骤、输入输出)
- [ ] API完整性: 创建、查询、执行、关联查询
- [ ] 向后兼容: 现有测试案例不受影响

---

### 功能5: Lua脚本支持

#### 功能描述

集成Lua脚本引擎，支持编写自定义逻辑、动态数据生成、复杂断言验证。

#### 功能价值

- **灵活性**: 10倍提升，支持任意复杂逻辑
- **扩展性**: 用户可自定义功能，无需修改平台代码
- **动态能力**: 运行时计算、条件判断、循环

#### 功能详情

**支持场景**:
- ✅ 动态生成测试数据（随机、批量）
- ✅ 复杂业务逻辑验证（如订单金额计算）
- ✅ 自定义断言函数
- ✅ 环境适配（根据环境切换配置）
- ✅ 数据转换（格式转换、加密解密）

**预定义函数库**:
- `httpRequest()` - 发起HTTP请求
- `json.decode()` / `json.encode()` - JSON处理
- `log.info()` / `log.error()` - 日志输出
- `assert()` - 断言
- `sleep()` - 延迟
- `uuid()` - 生成UUID
- `timestamp()` - 当前时间戳

**脚本示例**:
```lua
-- 动态生成100个测试用户
function generateUsers()
    local users = {}
    for i = 1, 100 do
        table.insert(users, {
            username = "user_" .. i,
            email = "user" .. i .. "@test.com",
            age = math.random(18, 60)
        })
    end
    return users
end

-- 复杂业务验证
function validateOrder(response)
    local order = response.data
    local total = 0

    for _, item in ipairs(order.items) do
        total = total + item.price * item.quantity
    end

    if total < 100 then
        total = total + order.shippingFee
    end

    total = total * (1 - order.discountRate)

    assert(
        math.abs(total - order.totalAmount) < 0.01,
        "订单金额错误"
    )
end
```

#### 用户界面

**脚本编辑器**:
```
┌─────────────────────────────────────────┐
│  💻 Lua 脚本编辑器                      │
├─────────────────────────────────────────┤
│  1  function validateOrder(response)    │
│  2      local order = response.data     │
│  3      local total = 0                 │
│  4                                      │
│  5      for _, item in ipairs(...) do   │
│  6          total = total + ...         │
│  7      end                             │
│  8                                      │
│  9      assert(total > 0)               │
│ 10  end                                 │
│                                         │
│  📚 函数库   🐛 调试   ▶️ 运行测试      │
└─────────────────────────────────────────┘
```

#### 安全机制

- ✅ 沙箱执行（禁用`os`、`io`等危险模块）
- ✅ 执行超时（默认5秒）
- ✅ 内存限制（最大10MB）
- ✅ 代码审查（敏感操作需审批）
- ✅ 权限控制（普通用户只能运行预定义脚本）

#### 验收标准

- [ ] 安全沙箱零漏洞
- [ ] 脚本执行时间 < 5秒（超时中止）
- [ ] 提供20+预定义函数
- [ ] 错误信息清晰（行号、错误类型）
- [ ] 脚本编辑器支持语法高亮

---

### 功能6: 模板系统

#### 功能描述

提供标准化的测试模板库，支持变量替换、模板继承、一键克隆，降低测试创建门槛。

#### 功能价值

- **降低门槛**: 新人从3天上手降至1天
- **标准化**: 统一团队测试规范
- **效率提升**: 从模板创建测试 < 30秒
- **知识沉淀**: 最佳实践固化为模板

#### 功能详情

**模板类型**:
1. **官方模板**（10+）:
   - RESTful CRUD
   - 用户认证（OAuth、JWT、Session）
   - 文件上传下载
   - 分页查询
   - 批量操作
   - WebSocket连接
   - GraphQL查询

2. **团队私有模板**:
   - 业务特定流程
   - 内部API规范

3. **个人模板**:
   - 个人常用模式

**变量替换**:
```json
{
  "name": "RESTful CRUD 模板",
  "variables": [
    {"name": "resource", "type": "string", "required": true},
    {"name": "baseUrl", "default": "http://localhost:8080"}
  ],
  "tests": [
    {
      "name": "创建${resource}",
      "http": {
        "method": "POST",
        "path": "${baseUrl}/${resource}"
      }
    }
  ]
}
```

**使用流程**:
1. 选择模板
2. 填写变量（resource=users, baseUrl=...）
3. 预览生成的测试
4. 确认创建

#### 用户界面

**模板市场**:
```
┌─────────────────────────────────────────────┐
│  🛒 模板市场                                │
├─────────────────────────────────────────────┤
│  [搜索框]  [分类筛选▼]  [排序: 最受欢迎▼]  │
├─────────────────────────────────────────────┤
│  ┌──────────────────┐  ┌──────────────────┐│
│  │ RESTful CRUD     │  │ JWT 认证         ││
│  │ ⭐⭐⭐⭐⭐          │  │ ⭐⭐⭐⭐           ││
│  │ 1,234 使用       │  │ 890 使用         ││
│  │ [预览] [使用]    │  │ [预览] [使用]    ││
│  └──────────────────┘  └──────────────────┘│
│  ┌──────────────────┐  ┌──────────────────┐│
│  │ 文件上传         │  │ 分页查询         ││
│  │ ⭐⭐⭐⭐           │  │ ⭐⭐⭐⭐⭐          ││
│  │ 567 使用         │  │ 2,100 使用       ││
│  │ [预览] [使用]    │  │ [预览] [使用]    ││
│  └──────────────────┘  └──────────────────┘│
└─────────────────────────────────────────────┘
```

**变量填写**:
```
┌─────────────────────────────────────────┐
│  📝 使用模板: RESTful CRUD              │
├─────────────────────────────────────────┤
│                                         │
│  资源名称 (resource) *                  │
│  ┌───────────────────────────────────┐ │
│  │ users                             │ │
│  └───────────────────────────────────┘ │
│                                         │
│  API 基础地址 (baseUrl)                 │
│  ┌───────────────────────────────────┐ │
│  │ http://localhost:8080/api         │ │
│  └───────────────────────────────────┘ │
│                                         │
│  [取消]          [预览]      [创建 →]  │
└─────────────────────────────────────────┘
```

#### 验收标准

- [ ] 提供10+官方模板
- [ ] 支持变量替换
- [ ] 模板预览功能
- [ ] 使用次数统计
- [ ] 评分系统（5星）
- [ ] 搜索和筛选功能

---

### 功能7: 前端现代化

#### 功能描述

使用Vite + React + TypeScript重构前端，提供现代化的用户体验，支持工作流可视化、结果可视化。

#### 功能价值

- **体验提升**: 页面加载从5秒降至2秒
- **交互流畅**: 响应时间 < 100ms
- **可视化**: 工作流编辑器、调用链图、趋势图
- **开发效率**: TypeScript类型安全，减少Bug

#### 功能详情

**核心页面**:
1. **仪表盘**: 测试统计、趋势图
2. **测试管理**: 列表、编辑、执行
3. **工作流编辑器**: 拖拽式编排
4. **结果可视化**: 调用链、时序图
5. **模板市场**: 浏览、搜索、使用

**技术特性**:
- ✅ 代码分割（按需加载）
- ✅ 懒加载（路由级别）
- ✅ 缓存优化
- ✅ WebSocket实时推送
- ✅ 响应式设计（适配桌面、平板）

#### 用户界面

**仪表盘**:
```
┌─────────────────────────────────────────────┐
│  📊 测试仪表盘                              │
├─────────────────────────────────────────────┤
│  ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐   │
│  │ 总数 │  │ 通过 │  │ 失败 │  │ 执行 │   │
│  │ 1234 │  │  987 │  │  123 │  │  124 │   │
│  └──────┘  └──────┘  └──────┘  └──────┘   │
│                                             │
│  ┌────────────────────────────────────┐    │
│  │  测试趋势图（最近7天）              │    │
│  │  📈 [折线图]                       │    │
│  └────────────────────────────────────┘    │
│                                             │
│  ┌────────────────────────────────────┐    │
│  │  失败率 Top 10                     │    │
│  │  📊 [条形图]                       │    │
│  └────────────────────────────────────┘    │
└─────────────────────────────────────────────┘
```

#### 验收标准

- [ ] 页面加载时间 < 2秒
- [ ] 交互响应 < 100ms
- [ ] Lighthouse评分 > 90
- [ ] 适配Chrome、Firefox、Safari
- [ ] 支持1920x1080及以上分辨率

---

### 功能8: 脚本管理

#### 功能描述

提供Lua脚本的集中管理功能，支持脚本版本控制、分类组织、共享复用、权限管理。

#### 功能价值

- **知识沉淀**: 将常用脚本沉淀为可复用资产
- **团队协作**: 脚本共享，减少重复开发
- **版本管理**: 追溯脚本变更历史
- **安全管控**: 权限控制，防止恶意脚本

#### 功能详情

**核心能力**:
- ✅ 脚本CRUD（创建、读取、更新、删除）
- ✅ 脚本分类（工具脚本、验证脚本、数据生成脚本）
- ✅ 版本管理（保存历史版本，支持回滚）
- ✅ 脚本搜索（按名称、分类、标签）
- ✅ 脚本共享（公开/私有/团队）
- ✅ 权限管理（创建者、管理员、普通用户）
- ✅ 使用统计（引用次数、执行次数）
- ✅ 安全审核（待审核、已批准、已拒绝）

#### 用户界面

**脚本库页面**:
```
┌─────────────────────────────────────────────────┐
│  📚 脚本库                    [➕ 新建脚本]      │
├─────────────────────────────────────────────────┤
│  [搜索框]  [分类▼]  [状态▼]  [排序: 最近更新▼] │
├─────────────────────────────────────────────────┤
│  脚本名称              分类        使用次数  状态│
│  📄 生成随机用户       工具脚本    234      ✅   │
│  📄 验证订单金额       验证脚本    156      ✅   │
│  📄 清理测试数据       工具脚本     89      🔒   │
│  📄 批量创建订单       数据生成     45      ⏳   │
│                                                 │
│  [查看详情] [编辑] [删除] [复制]                │
└─────────────────────────────────────────────────┘
```

**脚本详情页**:
```
┌─────────────────────────────────────────────────┐
│  📄 脚本详情 - 生成随机用户                     │
├─────────────────────────────────────────────────┤
│  基本信息                                       │
│  名称: 生成随机用户                             │
│  分类: 工具脚本                                 │
│  创建者: 张三                                   │
│  创建时间: 2025-11-20 10:30                     │
│  更新时间: 2025-11-21 09:15                     │
│  使用次数: 234                                  │
│  状态: ✅ 已批准                                │
│                                                 │
│  描述:                                          │
│  生成指定数量的随机测试用户数据                 │
│                                                 │
│  参数:                                          │
│  - count: 生成数量（默认10）                    │
│                                                 │
│  脚本内容: [代码编辑器]                         │
│                                                 │
│  版本历史:                                      │
│  v1.2 (当前) - 2025-11-21 09:15                │
│  v1.1         - 2025-11-20 15:20                │
│  v1.0         - 2025-11-20 10:30                │
│                                                 │
│  [编辑] [删除] [复制] [导出] [查看引用]         │
└─────────────────────────────────────────────────┘
```

**脚本编辑器**:
```
┌─────────────────────────────────────────────────┐
│  ✏️ 编辑脚本 - 生成随机用户                     │
├─────────────────────────────────────────────────┤
│  名称: [生成随机用户                          ] │
│  分类: [工具脚本 ▼]                            │
│  标签: [测试数据, 用户                        ] │
│  可见性: ○ 公开  ● 团队  ○ 私有                │
│                                                 │
│  描述:                                          │
│  ┌─────────────────────────────────────────┐   │
│  │ 生成指定数量的随机测试用户数据          │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
│  参数定义:                                      │
│  - count (number): 生成数量，默认10             │
│                                                 │
│  脚本内容:                                      │
│  1  function generateUsers(count)               │
│  2      count = count or 10                     │
│  3      local users = {}                        │
│  4      for i = 1, count do                     │
│  5          table.insert(users, {               │
│  6              username = "user_" .. uuid(),   │
│  7              email = "user" .. i .. "@...",  │
│  8              age = math.random(18, 60)       │
│  9          })                                  │
│ 10      end                                     │
│ 11      return users                            │
│ 12  end                                         │
│                                                 │
│  📚 函数库   🐛 测试运行   💾 保存版本          │
└─────────────────────────────────────────────────┘
```

#### 脚本分类

| 分类 | 说明 | 示例 |
|------|------|------|
| **工具脚本** | 通用工具函数 | UUID生成、时间格式化、随机数据 |
| **验证脚本** | 自定义断言和验证 | 订单金额验证、库存检查 |
| **数据生成** | 批量生成测试数据 | 批量用户、批量订单 |
| **转换脚本** | 数据格式转换 | JSON转换、加密解密 |
| **清理脚本** | 测试数据清理 | 删除测试用户、重置数据库 |

#### 脚本版本管理

**版本保存机制**:
- 每次保存创建新版本
- 保留完整的版本历史
- 支持版本对比（diff）
- 支持回滚到历史版本

**版本列表**:
```
┌─────────────────────────────────────────┐
│  📜 版本历史                            │
├─────────────────────────────────────────┤
│  版本    时间              修改者  备注 │
│  v1.2 ● 2025-11-21 09:15  张三   优化   │
│  v1.1   2025-11-20 15:20  张三   修复   │
│  v1.0   2025-11-20 10:30  张三   创建   │
│                                         │
│  [查看差异] [回滚到此版本]              │
└─────────────────────────────────────────┘
```

#### 权限管理

| 角色 | 创建 | 查看 | 编辑 | 删除 | 审核 |
|------|------|------|------|------|------|
| **创建者** | ✅ | ✅ | ✅ | ✅ | - |
| **管理员** | ✅ | ✅ | ✅ | ✅ | ✅ |
| **团队成员** | ✅ | ✅(团队/公开) | ❌ | ❌ | - |
| **普通用户** | ✅ | ✅(公开) | ❌ | ❌ | - |

#### 安全审核流程

```
创建脚本
   ↓
自动检测危险代码
   ↓
是否包含敏感操作？
   ├─ 否 → 自动批准 → 可使用
   └─ 是 → 待审核 → 管理员审核
                      ├─ 批准 → 可使用
                      └─ 拒绝 → 禁用
```

#### 验收标准

- [ ] 脚本CRUD完整
- [ ] 版本管理（保存、对比、回滚）
- [ ] 分类和标签管理
- [ ] 搜索和筛选
- [ ] 权限控制
- [ ] 安全审核流程
- [ ] 使用统计

---

### 功能9: 模板管理增强

#### 功能描述

在基础模板功能上增强，提供完整的模板生命周期管理，包括版本控制、分享、评价、数据分析。

#### 功能价值

- **持续优化**: 根据使用反馈改进模板
- **知识传播**: 优质模板快速推广
- **数据驱动**: 基于数据优化模板库
- **社区建设**: 形成模板生态

#### 功能详情

**增强能力**:
- ✅ 模板版本管理（类似脚本管理）
- ✅ 模板Fork（克隆并修改）
- ✅ 模板评价系统（评分、评论）
- ✅ 模板使用分析（使用趋势、成功率）
- ✅ 模板推荐（基于使用场景）
- ✅ 模板导入/导出（JSON格式）
- ✅ 模板依赖管理（模板引用其他模板）

#### 用户界面

**模板详情增强**:
```
┌─────────────────────────────────────────────────┐
│  📋 模板详情 - RESTful CRUD                     │
├─────────────────────────────────────────────────┤
│  ⭐⭐⭐⭐⭐ 4.8分 (256条评价)  🔥 1,234次使用    │
│                                                 │
│  分类: API测试                                  │
│  作者: 官方                                     │
│  创建: 2025-10-01  更新: 2025-11-20             │
│  版本: v2.1                                     │
│                                                 │
│  描述:                                          │
│  标准的RESTful API增删改查测试套件模板         │
│                                                 │
│  变量: resource, baseUrl                        │
│  生成测试数: 5个                                │
│                                                 │
│  📊 使用趋势: [过去30天折线图]                  │
│  📈 成功率: 98.5%                               │
│                                                 │
│  💬 用户评价:                                   │
│  ⭐⭐⭐⭐⭐ 张三: "非常好用，节省了大量时间"      │
│  ⭐⭐⭐⭐   李四: "建议增加批量操作模板"         │
│                                                 │
│  [使用此模板] [Fork] [导出] [分享]              │
└─────────────────────────────────────────────────┘
```

**模板分析仪表盘**:
```
┌─────────────────────────────────────────────────┐
│  📊 模板分析仪表盘                              │
├─────────────────────────────────────────────────┤
│  Top 10 最受欢迎模板                            │
│  1. RESTful CRUD        1,234次  ⭐4.8         │
│  2. JWT认证              890次   ⭐4.7         │
│  3. 文件上传             567次   ⭐4.6         │
│  ...                                            │
│                                                 │
│  使用趋势 [折线图]                              │
│  分类分布 [饼图]                                │
│  成功率统计 [条形图]                            │
└─────────────────────────────────────────────────┘
```

#### 模板评价系统

**评分维度**:
- 整体评分（1-5星）
- 易用性
- 文档完整度
- 功能覆盖度

**评论管理**:
- 文字评论
- 点赞/踩
- 评论回复
- 有用度排序

#### 验收标准

- [ ] 版本管理
- [ ] Fork功能
- [ ] 评分评论系统
- [ ] 使用趋势分析
- [ ] 导入导出
- [ ] 推荐算法

---

### 功能10: 数据库表格管理

#### 功能描述

提供可视化的数据库表格管理界面，支持数据库连接配置、表结构浏览、数据查询、数据操作，用于数据驱动测试和测试数据准备。

#### 功能价值

- **测试数据准备**: 直接在界面中准备测试数据
- **数据验证**: 测试后验证数据库状态
- **问题诊断**: 快速查看数据库数据排查问题
- **数据清理**: 批量清理测试数据

#### 功能详情

**核心能力**:
- ✅ 数据库连接管理（MySQL、PostgreSQL、SQLite）
- ✅ 表结构浏览（表列表、字段信息、索引、外键）
- ✅ 数据查询（SQL编辑器、结果展示）
- ✅ 数据操作（插入、更新、删除）
- ✅ 数据导入/导出（CSV、Excel）
- ✅ 查询历史记录
- ✅ 查询模板（常用查询保存）
- ✅ 数据Mock生成

#### 用户界面

**数据库连接管理**:
```
┌─────────────────────────────────────────────────┐
│  🗄️ 数据库连接                  [➕ 新建连接]   │
├─────────────────────────────────────────────────┤
│  名称              类型         状态      操作  │
│  测试数据库        MySQL        ✅ 在线   连接  │
│  生产数据库(只读)  PostgreSQL   ✅ 在线   连接  │
│  本地SQLite        SQLite       ✅ 在线   连接  │
│                                                 │
│  [测试连接] [编辑] [删除]                       │
└─────────────────────────────────────────────────┘
```

**新建连接对话框**:
```
┌─────────────────────────────────────────┐
│  ➕ 新建数据库连接                      │
├─────────────────────────────────────────┤
│  连接名称: [测试数据库              ]   │
│  数据库类型: [MySQL ▼]                 │
│                                         │
│  主机: [localhost                   ]   │
│  端口: [3306                        ]   │
│  数据库: [test_db                   ]   │
│  用户名: [root                      ]   │
│  密码: [••••••••                    ]   │
│                                         │
│  高级选项:                              │
│  □ 只读模式                             │
│  □ SSL连接                              │
│  连接超时: [30] 秒                      │
│                                         │
│  [测试连接]        [取消]  [保存]       │
└─────────────────────────────────────────┘
```

**表结构浏览**:
```
┌─────────────────────────────────────────────────┐
│  🗄️ 数据库: test_db                             │
├──────────────┬──────────────────────────────────┤
│  表列表      │  表详情 - users                  │
│              │                                  │
│  ▼ 业务表    │  字段信息:                       │
│   📊 users   │  名称      类型     NULL  键     │
│   📊 orders  │  id        INT      NO    PRI    │
│   📊 products│  username  VARCHAR  NO    UNI    │
│              │  email     VARCHAR  NO    UNI    │
│  ▼ 系统表    │  password  VARCHAR  NO           │
│   📊 logs    │  created_at DATETIME NO          │
│              │                                  │
│              │  索引:                           │
│              │  idx_username (username)         │
│              │  idx_email (email)               │
│              │                                  │
│              │  统计: 1,234 行                  │
│              │                                  │
│              │  [查看数据] [导出] [清空表]      │
└──────────────┴──────────────────────────────────┘
```

**SQL查询编辑器**:
```
┌─────────────────────────────────────────────────┐
│  💻 SQL 编辑器                                  │
├─────────────────────────────────────────────────┤
│  1  SELECT * FROM users                         │
│  2  WHERE created_at > '2025-11-01'             │
│  3  ORDER BY created_at DESC                    │
│  4  LIMIT 100;                                  │
│                                                 │
│  [▶️ 执行] [💾 保存查询] [📜 历史] [📚 模板]    │
├─────────────────────────────────────────────────┤
│  查询结果 (100 行, 执行时间: 45ms)              │
│  ┌────┬──────────┬──────────────┬───────────┐  │
│  │ id │ username │ email        │ created_at│  │
│  ├────┼──────────┼──────────────┼───────────┤  │
│  │ 1  │ user1    │ u1@test.com  │ 2025-11.. │  │
│  │ 2  │ user2    │ u2@test.com  │ 2025-11.. │  │
│  │... │ ...      │ ...          │ ...       │  │
│  └────┴──────────┴──────────────┴───────────┘  │
│                                                 │
│  [导出CSV] [导出Excel] [复制]                  │
└─────────────────────────────────────────────────┘
```

**数据操作界面**:
```
┌─────────────────────────────────────────────────┐
│  ✏️ 编辑数据 - users                             │
├─────────────────────────────────────────────────┤
│  id: 123 (只读)                                 │
│  username: [user_test_123                    ]  │
│  email: [test123@example.com                 ]  │
│  password: [••••••••                         ]  │
│  created_at: [2025-11-21 10:30:00            ]  │
│                                                 │
│  [保存] [取消] [删除此记录]                     │
└─────────────────────────────────────────────────┘
```

**批量数据Mock生成**:
```
┌─────────────────────────────────────────────────┐
│  🎲 批量生成测试数据                            │
├─────────────────────────────────────────────────┤
│  目标表: [users ▼]                             │
│  生成数量: [100                              ]  │
│                                                 │
│  字段映射:                                      │
│  username: [随机字符串(8-16位) ▼]              │
│  email:    [随机邮箱               ▼]          │
│  password: [固定值: 123456         ▼]          │
│  age:      [随机数(18-60)          ▼]          │
│                                                 │
│  高级选项:                                      │
│  □ 跳过重复记录                                 │
│  □ 使用事务                                     │
│                                                 │
│  [预览] [生成]                                  │
└─────────────────────────────────────────────────┘
```

**查询模板管理**:
```
┌─────────────────────────────────────────────────┐
│  📚 查询模板                     [➕ 新建模板]  │
├─────────────────────────────────────────────────┤
│  名称                  数据库      使用次数     │
│  查询最近注册用户      test_db     45           │
│  查询待支付订单        test_db     32           │
│  清理测试用户          test_db     28           │
│                                                 │
│  [使用] [编辑] [删除]                           │
└─────────────────────────────────────────────────┘
```

#### 数据库类型支持

| 数据库 | 支持版本 | 特性 |
|--------|---------|------|
| **MySQL** | 5.7+ | 完整支持 |
| **PostgreSQL** | 10+ | 完整支持 |
| **SQLite** | 3+ | 完整支持（本地文件） |
| **SQL Server** | 2016+ | Phase 2支持 |
| **Oracle** | 12c+ | Phase 2支持 |

#### 安全机制

| 安全措施 | 说明 |
|---------|------|
| **只读模式** | 生产数据库强制只读 |
| **危险操作确认** | DELETE/UPDATE/DROP需二次确认 |
| **操作审计** | 记录所有数据库操作 |
| **权限控制** | 基于角色的数据库访问权限 |
| **连接加密** | 支持SSL/TLS连接 |
| **SQL注入防护** | 参数化查询 |

#### 集成测试用例

**在测试中使用数据库**:
```yaml
workflow:
  steps:
    - id: prepare-data
      name: 准备测试数据
      type: database
      database: test_db
      operation: insert
      table: users
      data:
        username: "test_user_${timestamp}"
        email: "test_${timestamp}@example.com"
      output:
        userId: "last_insert_id"

    - id: api-test
      name: 测试API
      type: http
      http:
        method: GET
        path: "/api/users/${prepare-data.userId}"
      assertions:
        - type: status_code
          expected: 200

    - id: verify-db
      name: 验证数据库
      type: database
      database: test_db
      operation: query
      sql: "SELECT * FROM users WHERE id = ?"
      params: ["${prepare-data.userId}"]
      assertions:
        - field: username
          expected: "test_user_${timestamp}"

    - id: cleanup
      name: 清理数据
      type: database
      database: test_db
      operation: delete
      table: users
      where: "id = ?"
      params: ["${prepare-data.userId}"]
      runOnFailure: true
```

#### 验收标准

- [ ] 支持MySQL、PostgreSQL、SQLite
- [ ] 连接管理（增删改查）
- [ ] 表结构浏览
- [ ] SQL编辑器（语法高亮、自动补全）
- [ ] 查询结果展示（分页、导出）
- [ ] 数据CRUD
- [ ] 批量Mock生成
- [ ] 查询模板管理
- [ ] 只读模式和危险操作确认
- [ ] 操作审计日志

---

## 功能优先级

### MoSCoW 优先级模型

| 优先级 | 功能 | 理由 | 发布版本 |
|--------|------|------|----------|
| **Must Have** | 批量导入 | 最大痛点，效率提升明显 | v1.0 (Phase 1) |
| **Must Have** | 基础模板 | 降低门槛，配合导入使用 | v1.0 (Phase 1) |
| **Should Have** | 工作流（YAML） | 核心能力，支持复杂场景 | v2.0 (Phase 2) |
| **Should Have** | 测试案例与工作流集成 | 统一管理，真正实施 | v2.0 (Phase 2) |
| **Should Have** | Lua脚本 | 高级功能，赋能专家用户 | v3.0 (Phase 3) |
| **Should Have** | 脚本管理 | 配合Lua脚本，知识沉淀 | v3.0 (Phase 3) |
| **Could Have** | 模板管理增强 | 提升模板生态 | v3.5 (Phase 3.5) |
| **Could Have** | 数据库表格管理 | 数据驱动测试增强 | v3.5 (Phase 3.5) |
| **Could Have** | 工作流可视化编辑器 | 锦上添花，提升体验 | v4.0 (Phase 4) |
| **Could Have** | 结果可视化 | 辅助功能，帮助诊断 | v4.0 (Phase 4) |
| **Won't Have (Now)** | AI智能推荐 | 暂不实施，未来规划 | v5.0+ |

### 功能依赖关系

```
批量导入 ──────┐
              ├──> 完整的测试平台
基础模板 ──────┘
    │
    ├──> 工作流（YAML）
    │         │
    │         ├──> Lua脚本
    │         │
    │         └──> 工作流可视化
    │
    └──> 结果可视化
```

---

## 用户体验设计

### 设计原则

1. **简单优先**: 简单任务简单做，复杂任务也能做
2. **渐进披露**: 默认隐藏高级功能，按需展示
3. **即时反馈**: 每个操作都有明确反馈
4. **容错性**: 允许犯错，支持撤销和恢复
5. **一致性**: 统一的交互模式和视觉风格

### 关键交互流程

#### 流程1: 批量导入测试用例

```
开始
  ↓
[选择文件格式] → 引导提示
  ↓
[上传文件] → 进度条
  ↓
[自动验证] → 实时错误提示
  ↓
[预览结果] → 详细统计（成功/失败/警告）
  ↓
[确认导入] → 二次确认对话框
  ↓
[导入中...] → 进度条 + 实时状态
  ↓
[完成] → 成功提示 + 查看导入结果
```

**用户体验要点**:
- ⏱️ 上传大文件显示进度条
- ✅ 实时验证，即时错误提示
- 📊 清晰的统计信息
- 🔄 支持取消导入
- 📥 可下载错误报告

#### 流程2: 使用模板创建测试

```
开始
  ↓
[浏览模板市场] → 分类、搜索、排序
  ↓
[选择模板] → 预览模板内容
  ↓
[填写变量] → 表单验证、默认值
  ↓
[预览生成结果] → 实时预览
  ↓
[确认创建] → 一键创建
  ↓
[完成] → 跳转到测试详情页
```

**用户体验要点**:
- 🔍 智能搜索（模糊匹配）
- 👀 预览功能（所见即所得）
- ⚡ 一键创建（最少点击）
- 💾 自动保存草稿

### UI/UX规范

**色彩系统**:
- 主色: 蓝色（#1890ff）- 操作、链接
- 成功: 绿色（#52c41a）- 通过、成功
- 警告: 橙色（#faad14）- 警告
- 错误: 红色（#f5222d）- 失败、错误
- 中性: 灰色（#8c8c8c）- 次要信息

**字体规范**:
- 标题: 16-24px, Bold
- 正文: 14px, Regular
- 辅助: 12px, Regular
- 代码: Monaco, Consolas, monospace

**间距系统**:
- xs: 4px
- sm: 8px
- md: 16px
- lg: 24px
- xl: 32px

---

## 成功指标

### 关键绩效指标 (KPI)

| 指标类别 | 指标名称 | 基线 | 目标 | 测量方式 |
|---------|---------|------|------|---------|
| **效率** | 测试创建效率 | 1个/分钟 | 100个/分钟 | 导入功能性能测试 |
| **质量** | 工作流执行成功率 | - | > 95% | 执行日志统计 |
| **性能** | 页面加载时间 | 5秒 | < 2秒 | Lighthouse |
| **性能** | API响应时间 | 1秒 | < 500ms | APM监控 |
| **采纳** | 功能使用率 | - | > 50% | 埋点统计 |
| **满意度** | NPS评分 | 7/10 | > 9/10 | 用户调查 |
| **活跃** | DAU增长 | 100% | 120% | 登录日志 |

### 业务指标

| 指标 | 目标 | 说明 |
|------|------|------|
| **测试用例数** | +200% | 批量导入带来的增长 |
| **工作流数** | > 100 | 复杂场景覆盖 |
| **模板使用次数** | > 1000/月 | 模板受欢迎程度 |
| **新用户上手时间** | < 1天 | 从3天降至1天 |
| **测试维护成本** | -50% | 时间节省 |

---

## 技术约束

### 性能要求

| 指标 | 要求 | 验收方式 |
|------|------|---------|
| 导入1000条数据 | < 10秒 | 性能测试 |
| 工作流执行（10步骤） | < 30秒 | 性能测试 |
| Lua脚本执行 | < 5秒 | 超时控制 |
| 页面加载 | < 2秒 | Lighthouse |
| API响应 | < 500ms | APM |

### 可用性要求

| 指标 | 要求 |
|------|------|
| 系统可用性 | 99.9% |
| 数据持久化 | 100% |
| 并发用户 | 100+ |
| 工作流并发执行 | 50+ |

### 安全要求

| 要求 | 说明 |
|------|------|
| Lua沙箱 | 禁用危险模块 |
| 代码审查 | 敏感操作需审批 |
| 权限控制 | 基于角色的访问控制 |
| 数据加密 | 传输加密（HTTPS） |
| 审计日志 | 记录所有操作 |

### 兼容性要求

| 类型 | 要求 |
|------|------|
| 浏览器 | Chrome 90+, Firefox 88+, Safari 14+ |
| 屏幕分辨率 | 1920x1080+ |
| 操作系统 | Windows 10+, macOS 11+, Linux |
| Go版本 | 1.20+ |
| Node.js版本 | 18+ (前端构建) |

---

## 发布计划

### 版本规划

| 版本 | 发布时间 | 主要功能 | 里程碑 |
|------|---------|---------|--------|
| **v1.0** | 2025-04 | 批量导入 + 基础模板 | MVP上线 |
| **v2.0** | 2025-06 | 工作流（YAML编辑） | 核心能力 |
| **v3.0** | 2025-08 | Lua脚本支持 | 高级功能 |
| **v4.0** | 2025-10 | 前端现代化 + 可视化 | 体验升级 |

### v1.0 发布清单

**功能完成度**:
- [x] 批量导入（4种格式）
- [x] 基础模板系统
- [x] 批量执行
- [x] 导入历史查询
- [x] 10个官方模板

**测试通过**:
- [ ] 单元测试覆盖率 > 80%
- [ ] 集成测试通过
- [ ] 性能测试达标
- [ ] 安全测试通过
- [ ] UAT用户验收

**文档完成**:
- [ ] 用户手册
- [ ] API文档
- [ ] 模板开发指南
- [ ] FAQ
- [ ] 视频教程

**运维准备**:
- [ ] 部署文档
- [ ] 监控配置
- [ ] 备份方案
- [ ] 回滚预案

---

## 竞品分析

### 主要竞品

| 产品 | 定位 | 优势 | 劣势 | 差异化策略 |
|------|------|------|------|-----------|
| **Postman** | API测试工具 | • 生态成熟<br>• 易用性好<br>• 协作功能强 | • 非开源<br>• 企业版昂贵<br>• 功能过于庞大 | 专注工作流编排、轻量级 |
| **Katalon** | 自动化测试平台 | • 录制回放<br>• 跨平台<br>• CI/CD集成 | • 学习曲线陡<br>• 性能一般 | Lua脚本更灵活、更轻量 |
| **JMeter** | 性能测试工具 | • 开源免费<br>• 插件丰富 | • UI陈旧<br>• 配置复杂 | 现代化UI、更易用 |
| **Playwright** | E2E测试框架 | • 强大<br>• 多浏览器 | • 纯代码<br>• 无UI管理 | 提供UI + 脚本双模式 |

### 竞争优势

| 维度 | 我们的优势 |
|------|-----------|
| **成本** | 开源免费，无企业版费用 |
| **定制** | 内部开发，可快速响应需求 |
| **集成** | 与现有系统深度集成 |
| **轻量** | 专注核心功能，不臃肿 |
| **工作流** | 可视化编排 + Lua脚本 = 独特优势 |

---

## 附录

### A. 术语表

| 术语 | 定义 |
|------|------|
| **PRD** | Product Requirements Document，产品需求文档 |
| **MVP** | Minimum Viable Product，最小可行产品 |
| **NPS** | Net Promoter Score，净推荐值 |
| **DAU** | Daily Active Users，日活跃用户 |
| **KPI** | Key Performance Indicator，关键绩效指标 |
| **CI/CD** | Continuous Integration/Continuous Deployment |
| **UAT** | User Acceptance Testing，用户验收测试 |

### B. 参考资料

- [Postman 工作流文档](https://learning.postman.com/docs/running-collections/building-workflows/)
- [Katalon 数据驱动测试](https://docs.katalon.com/katalon-studio/docs/ddt.html)
- [Lua 官方文档](https://www.lua.org/manual/5.4/)
- [React Flow 文档](https://reactflow.dev/)

### C. 变更记录

| 版本 | 日期 | 变更内容 | 变更人 |
|------|------|---------|--------|
| 1.0 | 2025-11-21 | 初始版本 | 产品团队 |

---

**文档结束**

**审批流程**:
- [ ] 产品负责人审批: ________________
- [ ] 技术负责人审批: ________________
- [ ] 测试负责人审批: ________________
- [ ] 项目经理审批: ________________
